import{l as v,u as g}from"./index-EniEsKef.js";import{u as w}from"./index-p2Z0r7Du.js";import{u as y,a as C}from"./index-Q0pOrvmv.js";import{s as k,m as S,d as E,i as b,o as x,c as M}from"./index-CaiZ4ldM.js";import{u as B}from"./index-hrmxfCrV.js";function V(o={}){const{factory:a,dispose:l=!0,...c}=o,u=k(null);function p(){const e=a?a(c):_()&&new v.Control.Locate(c);u.value=S(e)}function _(){if(typeof v.Control.Locate!="function")throw new Error('Leaflet extension not installed: "@leaflet-extensions/locatecontrol"');return!0}return y(u,{dispose:l}),p(),u}function m(o){"@babel/helpers - typeof";return m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},m(o)}/*!
Copyright (c) 2016 Dominik Moritz

This file is part of the leaflet locate control. It is licensed under the MIT license.
You can find the project at: https://github.com/domoritz/leaflet-locatecontrol
*/(function(o,a){typeof define=="function"&&define.amd?define(["leaflet"],o):(typeof exports>"u"?"undefined":m(exports))==="object"&&(typeof a<"u"&&a.L?module.exports=o(L):module.exports=o(require("leaflet"))),typeof a<"u"&&a.L&&(a.L.Control.Locate=o(L))})(function(o){var a=function(t,i,s){s=s.split(" "),s.forEach(function(n){o.DomUtil[t].call(this,i,n)})},l=function(t,i){return a("addClass",t,i)},c=function(t,i){return a("removeClass",t,i)},u=o.Marker.extend({initialize:function(t,i){o.Util.setOptions(this,i),this._latlng=t,this.createIcon()},createIcon:function(){var t=this.options,i="";t.color!==void 0&&(i+="stroke:".concat(t.color,";")),t.weight!==void 0&&(i+="stroke-width:".concat(t.weight,";")),t.fillColor!==void 0&&(i+="fill:".concat(t.fillColor,";")),t.fillOpacity!==void 0&&(i+="fill-opacity:".concat(t.fillOpacity,";")),t.opacity!==void 0&&(i+="opacity:".concat(t.opacity,";"));var s=this._getIconSVG(t,i);this._locationIcon=o.divIcon({className:s.className,html:s.svg,iconSize:[s.w,s.h]}),this.setIcon(this._locationIcon)},_getIconSVG:function(t,i){var s=t.radius,n=t.weight,r=s+n,h=r*2,f='<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(h,'" height="').concat(h,'" version="1.1" viewBox="-').concat(r," -").concat(r," ").concat(h," ").concat(h,'">')+'<circle r="'+s+'" style="'+i+'" /></svg>';return{className:"leaflet-control-locate-location",svg:f,w:h,h}},setStyle:function(t){o.Util.setOptions(this,t),this.createIcon()}}),p=u.extend({initialize:function(t,i,s){o.Util.setOptions(this,s),this._latlng=t,this._heading=i,this.createIcon()},setHeading:function(t){this._heading=t},_getIconSVG:function(t,i){var s=t.radius,n=t.width+t.weight,r=(s+t.depth+t.weight)*2,h="M0,0 l".concat(t.width/2,",").concat(t.depth," l-").concat(n,",0 z"),f="transform: rotate(".concat(this._heading,"deg)"),d='<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(n,'" height="').concat(r,'" version="1.1" viewBox="-').concat(n/2," 0 ").concat(n," ").concat(r,'" style="').concat(f,'">')+'<path d="'+h+'" style="'+i+'" /></svg>';return{className:"leaflet-control-locate-heading",svg:d,w:n,h:r}}}),_=o.Control.extend({options:{position:"topleft",layer:void 0,setView:"untilPanOrZoom",keepCurrentZoomLevel:!1,initialZoomLevel:!1,getLocationBounds:function(t){return t.bounds},flyTo:!1,clickBehavior:{inView:"stop",outOfView:"setView",inViewNotFollowing:"inView"},returnToPrevBounds:!1,cacheLocation:!0,drawCircle:!0,drawMarker:!0,showCompass:!0,markerClass:u,compassClass:p,circleStyle:{className:"leaflet-control-locate-circle",color:"#136AEC",fillColor:"#136AEC",fillOpacity:.15,weight:0},markerStyle:{className:"leaflet-control-locate-marker",color:"#fff",fillColor:"#2A93EE",fillOpacity:1,weight:3,opacity:1,radius:9},compassStyle:{fillColor:"#2A93EE",fillOpacity:1,weight:0,color:"#fff",opacity:1,radius:9,width:9,depth:6},followCircleStyle:{},followMarkerStyle:{},followCompassStyle:{},icon:"leaflet-control-locate-location-arrow",iconLoading:"leaflet-control-locate-spinner",iconElementTag:"span",textElementTag:"small",circlePadding:[0,0],metric:!0,createButtonCallback:function(t,i){var s=o.DomUtil.create("a","leaflet-bar-part leaflet-bar-part-single",t);s.title=i.strings.title,s.href="#",s.setAttribute("role","button");var n=o.DomUtil.create(i.iconElementTag,i.icon,s);if(i.strings.text!==void 0){var r=o.DomUtil.create(i.textElementTag,"leaflet-locate-text",s);r.textContent=i.strings.text,s.classList.add("leaflet-locate-text-active"),s.parentNode.style.display="flex",i.icon.length>0&&n.classList.add("leaflet-locate-icon")}return{link:s,icon:n}},onLocationError:function(t,i){alert(t.message)},onLocationOutsideMapBounds:function(t){t.stop(),alert(t.options.strings.outsideMapBoundsMsg)},showPopup:!0,strings:{title:"Show me where I am",metersUnit:"meters",feetUnit:"feet",popup:"You are within {distance} {unit} from this point",outsideMapBoundsMsg:"You seem located outside the boundaries of the map"},locateOptions:{maxZoom:1/0,watch:!0,setView:!1}},initialize:function(t){for(var i in t)m(this.options[i])==="object"?o.extend(this.options[i],t[i]):this.options[i]=t[i];this.options.followMarkerStyle=o.extend({},this.options.markerStyle,this.options.followMarkerStyle),this.options.followCircleStyle=o.extend({},this.options.circleStyle,this.options.followCircleStyle),this.options.followCompassStyle=o.extend({},this.options.compassStyle,this.options.followCompassStyle)},onAdd:function(t){var i=o.DomUtil.create("div","leaflet-control-locate leaflet-bar leaflet-control");this._container=i,this._map=t,this._layer=this.options.layer||new o.LayerGroup,this._layer.addTo(t),this._event=void 0,this._compassHeading=null,this._prevBounds=null;var s=this.options.createButtonCallback(i,this.options);return this._link=s.link,this._icon=s.icon,o.DomEvent.on(this._link,"click",function(n){o.DomEvent.stopPropagation(n),o.DomEvent.preventDefault(n),this._onClick()},this).on(this._link,"dblclick",o.DomEvent.stopPropagation),this._resetVariables(),this._map.on("unload",this._unload,this),i},_onClick:function(){this._justClicked=!0;var t=this._isFollowing();if(this._userPanned=!1,this._userZoomed=!1,this._active&&!this._event)this.stop();else if(this._active){var i=this.options.clickBehavior,s=i.outOfView;switch(this._map.getBounds().contains(this._event.latlng)&&(s=t?i.inView:i.inViewNotFollowing),i[s]&&(s=i[s]),s){case"setView":this.setView();break;case"stop":if(this.stop(),this.options.returnToPrevBounds){var n=this.options.flyTo?this._map.flyToBounds:this._map.fitBounds;n.bind(this._map)(this._prevBounds)}break}}else this.options.returnToPrevBounds&&(this._prevBounds=this._map.getBounds()),this.start();this._updateContainerStyle()},start:function(){this._activate(),this._event&&(this._drawMarker(this._map),this.options.setView&&this.setView()),this._updateContainerStyle()},stop:function(){this._deactivate(),this._cleanClasses(),this._resetVariables(),this._removeMarker()},stopFollowing:function(){this._userPanned=!0,this._updateContainerStyle(),this._drawMarker()},_activate:function(){if(!(this._active||!this._map)&&(this._map.locate(this.options.locateOptions),this._map.fire("locateactivate",this),this._active=!0,this._map.on("locationfound",this._onLocationFound,this),this._map.on("locationerror",this._onLocationError,this),this._map.on("dragstart",this._onDrag,this),this._map.on("zoomstart",this._onZoom,this),this._map.on("zoomend",this._onZoomEnd,this),this.options.showCompass)){var t="ondeviceorientationabsolute"in window;if(t||"ondeviceorientation"in window){var i=this,s=function(){o.DomEvent.on(window,t?"deviceorientationabsolute":"deviceorientation",i._onDeviceOrientation,i)};DeviceOrientationEvent&&typeof DeviceOrientationEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(function(n){n==="granted"&&s()}):s()}}},_deactivate:function(){!this._active||!this._map||(this._map.stopLocate(),this._map.fire("locatedeactivate",this),this._active=!1,this.options.cacheLocation||(this._event=void 0),this._map.off("locationfound",this._onLocationFound,this),this._map.off("locationerror",this._onLocationError,this),this._map.off("dragstart",this._onDrag,this),this._map.off("zoomstart",this._onZoom,this),this._map.off("zoomend",this._onZoomEnd,this),this.options.showCompass&&(this._compassHeading=null,"ondeviceorientationabsolute"in window?o.DomEvent.off(window,"deviceorientationabsolute",this._onDeviceOrientation,this):"ondeviceorientation"in window&&o.DomEvent.off(window,"deviceorientation",this._onDeviceOrientation,this)))},setView:function(){if(this._drawMarker(),this._isOutsideMapBounds())this._event=void 0,this.options.onLocationOutsideMapBounds(this);else if(this._justClicked&&this.options.initialZoomLevel!==!1){var t=this.options.flyTo?this._map.flyTo:this._map.setView;t.bind(this._map)([this._event.latitude,this._event.longitude],this.options.initialZoomLevel)}else if(this.options.keepCurrentZoomLevel){var t=this.options.flyTo?this._map.flyTo:this._map.panTo;t.bind(this._map)([this._event.latitude,this._event.longitude])}else{var t=this.options.flyTo?this._map.flyToBounds:this._map.fitBounds;this._ignoreEvent=!0,t.bind(this._map)(this.options.getLocationBounds(this._event),{padding:this.options.circlePadding,maxZoom:this.options.initialZoomLevel||this.options.locateOptions.maxZoom}),o.Util.requestAnimFrame(function(){this._ignoreEvent=!1},this)}},_drawCompass:function(){if(this._event){var t=this._event.latlng;if(this.options.showCompass&&t&&this._compassHeading!==null){var i=this._isFollowing()?this.options.followCompassStyle:this.options.compassStyle;this._compass?(this._compass.setLatLng(t),this._compass.setHeading(this._compassHeading),this._compass.setStyle&&this._compass.setStyle(i)):this._compass=new this.options.compassClass(t,this._compassHeading,i).addTo(this._layer)}this._compass&&(!this.options.showCompass||this._compassHeading===null)&&(this._compass.removeFrom(this._layer),this._compass=null)}},_drawMarker:function(){this._event.accuracy===void 0&&(this._event.accuracy=0);var t=this._event.accuracy,i=this._event.latlng;if(this.options.drawCircle){var s=this._isFollowing()?this.options.followCircleStyle:this.options.circleStyle;this._circle?this._circle.setLatLng(i).setRadius(t).setStyle(s):this._circle=o.circle(i,t,s).addTo(this._layer)}var n,r;if(this.options.metric?(n=t.toFixed(0),r=this.options.strings.metersUnit):(n=(t*3.2808399).toFixed(0),r=this.options.strings.feetUnit),this.options.drawMarker){var h=this._isFollowing()?this.options.followMarkerStyle:this.options.markerStyle;this._marker?(this._marker.setLatLng(i),this._marker.setStyle&&this._marker.setStyle(h)):this._marker=new this.options.markerClass(i,h).addTo(this._layer)}this._drawCompass();var f=this.options.strings.popup;function d(){return typeof f=="string"?o.Util.template(f,{distance:n,unit:r}):typeof f=="function"?f({distance:n,unit:r}):f}this.options.showPopup&&f&&this._marker&&this._marker.bindPopup(d())._popup.setLatLng(i),this.options.showPopup&&f&&this._compass&&this._compass.bindPopup(d())._popup.setLatLng(i)},_removeMarker:function(){this._layer.clearLayers(),this._marker=void 0,this._circle=void 0},_unload:function(){this.stop(),this._map.off("unload",this._unload,this)},_setCompassHeading:function(t){!isNaN(parseFloat(t))&&isFinite(t)?(t=Math.round(t),this._compassHeading=t,o.Util.requestAnimFrame(this._drawCompass,this)):this._compassHeading=null},_onCompassNeedsCalibration:function(){this._setCompassHeading()},_onDeviceOrientation:function(t){this._active&&(t.webkitCompassHeading?this._setCompassHeading(t.webkitCompassHeading):t.absolute&&t.alpha&&this._setCompassHeading(360-t.alpha))},_onLocationError:function(t){t.code==3&&this.options.locateOptions.watch||(this.stop(),this.options.onLocationError(t,this))},_onLocationFound:function(t){if(!(this._event&&this._event.latlng.lat===t.latlng.lat&&this._event.latlng.lng===t.latlng.lng&&this._event.accuracy===t.accuracy)&&this._active){switch(this._event=t,this._drawMarker(),this._updateContainerStyle(),this.options.setView){case"once":this._justClicked&&this.setView();break;case"untilPan":this._userPanned||this.setView();break;case"untilPanOrZoom":!this._userPanned&&!this._userZoomed&&this.setView();break;case"always":this.setView();break}this._justClicked=!1}},_onDrag:function(){this._event&&!this._ignoreEvent&&(this._userPanned=!0,this._updateContainerStyle(),this._drawMarker())},_onZoom:function(){this._event&&!this._ignoreEvent&&(this._userZoomed=!0,this._updateContainerStyle(),this._drawMarker())},_onZoomEnd:function(){this._event&&this._drawCompass(),this._event&&!this._ignoreEvent&&this._marker&&!this._map.getBounds().pad(-.3).contains(this._marker.getLatLng())&&(this._userPanned=!0,this._updateContainerStyle(),this._drawMarker())},_isFollowing:function(){if(!this._active)return!1;if(this.options.setView==="always")return!0;if(this.options.setView==="untilPan")return!this._userPanned;if(this.options.setView==="untilPanOrZoom")return!this._userPanned&&!this._userZoomed},_isOutsideMapBounds:function(){return this._event===void 0?!1:this._map.options.maxBounds&&!this._map.options.maxBounds.contains(this._event.latlng)},_updateContainerStyle:function(){this._container&&(this._active&&!this._event?this._setClasses("requesting"):this._isFollowing()?this._setClasses("following"):this._active?this._setClasses("active"):this._cleanClasses())},_setClasses:function(t){t=="requesting"?(c(this._container,"active following"),l(this._container,"requesting"),c(this._icon,this.options.icon),l(this._icon,this.options.iconLoading)):t=="active"?(c(this._container,"requesting following"),l(this._container,"active"),c(this._icon,this.options.iconLoading),l(this._icon,this.options.icon)):t=="following"&&(c(this._container,"requesting"),l(this._container,"active following"),c(this._icon,this.options.iconLoading),l(this._icon,this.options.icon))},_cleanClasses:function(){o.DomUtil.removeClass(this._container,"requesting"),o.DomUtil.removeClass(this._container,"active"),o.DomUtil.removeClass(this._container,"following"),c(this._icon,this.options.iconLoading),l(this._icon,this.options.icon)},_resetVariables:function(){this._active=!1,this._justClicked=!1,this._userPanned=!1,this._userZoomed=!1}});return o.control.locate=function(e){return new o.Control.Locate(e)},_},window);const T=E({__name:"demo",setup(o){const a=b(null),l=g(a),c=w("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png");B(l,c);const u=V();return C(l,u),(p,_)=>(x(),M("div",{ref_key:"el",ref:a,style:{height:"25rem"}},null,512))}});export{T as default};
